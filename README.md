# LLM Honeypot v2.0

An advanced SSH honeypot powered by Large Language Models (LLMs) that simulates a realistic Linux terminal environment to attract and analyze potential attackers.

## ğŸ¯ Overview

This honeypot creates an interactive SSH server that responds to commands with realistic Linux terminal outputs generated by Google's Gemini LLM. It maintains session persistence, handles complex command scenarios, and logs all attacker interactions for security analysis.

## ğŸ—ï¸ Architecture

### Core Components

- **`main.py`** - Entry point that initializes the SSH server and LLM
- **`ssh_server.py`** - SSH server implementation using Paramiko
- **`llm.py`** - LLM integration for command response generation
- **`personalitySSH.yml`** - Comprehensive system prompt defining terminal behavior
- **`fewshots.json`** - Extensive collection of command-response examples for few-shot learning

### Key Features

- **Realistic Linux Terminal Simulation**: Responds authentically to hundreds of Linux commands
- **Session Persistence**: Maintains filesystem state, working directory, and command history
- **Advanced Command Support**: File operations, network tools, process management, text processing
- **Corporate Environment**: Simulates realistic IT infrastructure with fake sensitive data
- **Comprehensive Error Handling**: Proper error messages for invalid commands and permissions
- **Security Logging**: Captures all authentication attempts and command interactions

## Quick Start

### Prerequisites

- Python 3.8+
- Google Gemini API Key
- Required Python packages (see Installation)

### Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd "v2.0 LLM-Honeypot-main"
   ```

2. **Install dependencies**
   ```bash
   pip install paramiko openai pyyaml
   ```

3. **Configure API Key**
   
   Edit `honeypot-server/.env` and add your Gemini API key:
   ```env
   GEMINI_API_KEY=your_gemini_api_key_here
   ```

4. **Start the honeypot**
   ```bash
   cd honeypot-server
   python main.py
   ```

### Connect to Honeypot

```bash
ssh -T -p 2222 root@localhost
```

Default credentials: Any username/password combination will be accepted and logged.

## ğŸ“ Project Structure

```
v2.0 LLM-Honeypot-main/
â”œâ”€â”€ honeypot-server/           # Main honeypot application
â”‚   â”œâ”€â”€ main.py               # Entry point
â”‚   â”œâ”€â”€ ssh_server.py         # SSH server implementation
â”‚   â”œâ”€â”€ llm.py               # LLM integration
â”‚   â”œâ”€â”€ personalitySSH.yml   # System prompt configuration
â”‚   â”œâ”€â”€ fewshots.json        # Few-shot examples (627+ entries)
â”‚   â”œâ”€â”€ .env                 # API key configuration
â”‚   â”œâ”€â”€ logs/                # Connection and command logs
â”‚   â”œâ”€â”€ tests/               # Unit tests
â”‚   â””â”€â”€ README.md            # Basic setup instructions
â”œâ”€â”€ notebooks/               # Evaluation and analysis
â”‚   â””â”€â”€ evaluation.ipynb     # Performance evaluation pipeline
â””â”€â”€ README.md               # This comprehensive documentation
```

## âš™ï¸ Configuration

### Environment Variables

- `GEMINI_API_KEY` - Google Gemini API key (required)
- `API_KEY` - Alternative API key variable
- `MODEL_NAME` - LLM model to use (default: `gemini-2.0-flash`)

### Personality Configuration

The `personalitySSH.yml` file contains detailed instructions for the LLM, including:

- Terminal behavior guidelines
- Command response patterns
- File system structure
- Error handling protocols
- Corporate environment simulation
- Security restrictions

### Few-Shot Examples

`fewshots.json` contains 627+ command-response pairs covering:

- Basic file operations (`ls`, `cd`, `pwd`, `cat`)
- System information (`uname`, `df`, `ps`, `top`)
- Network tools (`ping`, `curl`, `wget`, `netstat`)
- Text processing (`grep`, `sed`, `awk`, `sort`)
- Archive operations (`tar`, `zip`, `gzip`)
- Error scenarios and edge cases

## ğŸ”§ Customization

### Adding New Commands

1. Update `fewshots.json` with new command-response pairs
2. Optionally modify `personalitySSH.yml` for behavior changes
3. Restart the server to apply changes

### Modifying Terminal Behavior

Edit `personalitySSH.yml` to adjust:
- Response formats
- Error messages
- File system structure
- Permission settings
- Corporate environment details

### Changing LLM Model

Update the model in `.env` or modify `llm.py`:
```python
self.api_model = "your-preferred-model"
```

## ğŸ“Š Evaluation

The project includes a comprehensive evaluation pipeline in `notebooks/evaluation.ipynb`:

- **Performance Metrics**: Compare LLM responses against reference outputs
- **Similarity Analysis**: Use NLP metrics (BLEU, ROUGE, edit distance)
- **Command Coverage**: Test response quality across different command categories
- **Error Handling**: Validate error message accuracy

### Running Evaluation

1. Install evaluation dependencies:
   ```bash
   pip install pandas numpy matplotlib scikit-learn spacy jellyfish nltk
   ```

2. Launch Jupyter and open the evaluation notebook:
   ```bash
   jupyter notebook notebooks/evaluation.ipynb
   ```

## ğŸ”’ Security Features

### Authentication Logging

All login attempts are captured:
```log
[!] Auth Attempt: username:password
```

### Command Logging

Every executed command is logged:
```log
[CMD] ls -la
```

### Session Persistence

- Maintains file system state across commands
- Tracks current working directory
- Remembers file creations and modifications
- Preserves environment variables

### Realistic Restrictions

- Proper permission denied messages
- Sudo restrictions with security logging
- Corporate policy enforcement
- Network tool limitations

## ğŸ§ª Testing

Run the test suite:

```bash
cd honeypot-server
python -m pytest tests/
```

### Test Coverage

- **LLM Integration**: API communication and response handling
- **Prompt Building**: Few-shot example integration
- **Command Processing**: Input parsing and response formatting

## ğŸ“ Logging

### SSH Server Logs
- Location: `paramiko.log`
- Contains detailed SSH connection information

### Command Logs
- Location: `logs/log_YYYY-MM-DD_HH-MM-SS.txt`
- Format: Command-response pairs with timestamps

### Authentication Logs
- Location: `logs/auth.log`
- Format: `username:password` pairs

## ğŸš¨ Important Notes

### Security Considerations

- **API Key Protection**: Keep your Gemini API key secure
- **Network Exposure**: Consider firewall rules for production deployment
- **Log Monitoring**: Regularly review authentication logs for attack patterns
- **Resource Limits**: Monitor API usage to avoid unexpected costs

### Limitations

- Read-only file system (simulated)
- No actual system modifications
- Dependent on LLM availability and accuracy
- Response latency varies with API performance

## ğŸ› ï¸ Troubleshooting

### Common Issues

1. **API Key Not Found**
   ```
   [-] Error: GEMINI_API_KEY not found. Please check your .env file.
   ```
   - Verify `.env` file exists in `honeypot-server/`
   - Check API key format and permissions

2. **Port Already in Use**
   ```
   Error binding to port 2222: [Errno 98] Address already in use
   ```
   - Change port in `main.py` or stop conflicting services
   - Use `netstat -tulpn | grep 2222` to find conflicts

3. **SSH Connection Refused**
   - Verify server is running
   - Check firewall settings
   - Ensure correct port (default: 2222)

4. **LLM Response Errors**
   - Check API key validity
   - Verify network connectivity
   - Monitor API quota limits

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Update documentation
5. Submit a pull request

## ğŸ“„ License

This project is provided for educational and research purposes. Use responsibly and in accordance with applicable laws and regulations.

## ğŸ™ Acknowledgments

- Google Gemini for LLM capabilities
- Paramiko for SSH server implementation
- Security research community for honeypot insights

---

**âš ï¸ Disclaimer**: This tool is designed for security research and educational purposes only. Users are responsible for ensuring compliance with all applicable laws and regulations when deploying this honeypot.
